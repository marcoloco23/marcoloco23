# GitHub Metrics Generation Workflow
# Powered by lowlighter/metrics: https://github.com/lowlighter/metrics
# Documentation: https://github.com/lowlighter/metrics/blob/master/README.md
#
# This workflow generates comprehensive GitHub statistics and renders them as SVG files
# The generated files are automatically committed to the repository and displayed in README.md
#
# Schedule: Runs daily at midnight UTC
# Manual trigger: Available via GitHub Actions UI

name: GitHub Metrics Generation
on:
  # Automatic execution daily at midnight UTC
  schedule:
    - cron: "0 0 * * *"
  # Manual execution via GitHub Actions UI
  workflow_dispatch:
  # Run on push to main branch (for testing)
  push:
    branches: [main]

jobs:
  github-metrics:
    name: Generate Comprehensive GitHub Metrics
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: read
    steps:
      - name: Generate GitHub Metrics
        uses: lowlighter/metrics@latest
        with:
          # Configuration reference: https://github.com/lowlighter/metrics/blob/master/.github/readme/partials/documentation/setup/action.md
          # Authentication token (required)
          # Create at: https://github.com/settings/tokens
          # Required scopes: public_repo, read:user, read:org, repo (for private repos)
          token: ${{ secrets.METRICS_TOKEN }}

          # Use GitHub token for commits (recommended approach)
          committer_token: ${{ secrets.GITHUB_TOKEN }}
          committer_branch: main
          committer_message: "Update GitHub metrics"

          # === CORE CONFIGURATION ===
          user: marcoloco23
          commits_authoring: marcoloco23, ${{ secrets.AUTHOR_EMAILS }}
          config_timezone: America/New_York
          template: classic

          # Repository settings
          repositories: 1000
          repositories_batch: 5
          repositories_affiliations: owner, collaborator, organization_member
          repositories_skipped: ""

          # Output configuration - generates multiple SVG files
          config_order: base.header, base.activity+community, isocalendar, habits, languages, notable, reactions, stargazers, calendar

          # === BASE METRICS ===
          base: header, activity, community, repositories, metadata
          base_indepth: yes
          base_hireable: yes
          base_skip: yes

          # === PLUGIN: ISOMETRIC CALENDAR ===
          # Displays contribution calendar in 3D isometric view
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year

          # === PLUGIN: CODING HABITS ===
          # Analyzes coding patterns and habits
          plugin_habits: yes
          plugin_habits_from: 1000
          plugin_habits_days: 30
          plugin_habits_facts: yes
          plugin_habits_charts: yes
          plugin_habits_charts_type: classic
          plugin_habits_trim: yes

          # === PLUGIN: LANGUAGES ===
          # Programming languages breakdown
          plugin_languages: yes
          plugin_languages_details: percentage, lines, bytes-size
          plugin_languages_indepth: yes
          plugin_languages_analysis_timeout: 30
          plugin_languages_categories: programming
          plugin_languages_colors: github
          plugin_languages_sections: most-used, recently-used
          plugin_languages_threshold: 0%
          plugin_languages_limit: 12

          # === PLUGIN: NOTABLE CONTRIBUTIONS ===
          # Highlights significant contributions
          plugin_notable: yes
          plugin_notable_from: organization
          plugin_notable_repositories: yes
          plugin_notable_types: commit, pull_request, issue
          plugin_notable_indepth: yes
          plugin_notable_self: yes

          # === PLUGIN: REACTIONS ===
          # Community engagement metrics
          plugin_reactions: yes
          plugin_reactions_limit: 1000
          plugin_reactions_limit_issues: 1000
          plugin_reactions_limit_discussions: 1000
          plugin_reactions_limit_discussions_comments: 1000
          plugin_reactions_display: absolute
          plugin_reactions_details: count, percentage

          # === PLUGIN: STARGAZERS ===
          # Repository stargazer analytics
          plugin_stargazers: yes
          plugin_stargazers_charts: yes
          plugin_stargazers_charts_type: classic
          plugin_stargazers_worldmap: no # Disabled to avoid API dependency

          # === PLUGIN: CALENDAR ===
          # Contribution calendar with enhanced styling
          plugin_calendar: yes
          plugin_calendar_limit: 0

          # === OPTIMIZATION SETTINGS ===
          # Performance and reliability improvements
          optimize: css, xml, svg
          experimental_features: --optimize-svg
          use_prebuilt_image: yes

          # Error handling
          plugins_errors_fatal: no
          debug: no
          verify: no

          # Output settings
          config_display: large
          config_animations: yes
          config_padding: 6%
